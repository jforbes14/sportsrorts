---
title: "Sports Rorts"
author: "Jeremy Forbes"
date: "19/02/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

## Uncovering the Sports Rorts bias in 2020 using stats

In 2018, the Australian government announced a community sport infrastructure program, offering grants of up to $500,000 to fund local sporting clubs and organisations in the hope of boosting participation across the country. Any club wanting to apply for funding could submit an application stating how they'd use the infrastructure grant money, and why it was needed. The applications were then independently assessed by Sport Australia and given a score for the Sports Minister (Senator Bridget McKenzie) to use in having the final say on which grants would be approved.

A recent audit on the funding scheme by the Australian National Audit Office (ANAO) found that "the award of grant funding was not informed by an appropriate assessment process and sound advice". Their findings imply that the government, led by the Liberal-National Coalition, gave preference to grant applications from 'marginal' and 'targeted' electorates. 'Marginal' seats are those won by the Coalition in the 2016 election, and 'targeted' seats are electorates held by minor parties that the Coalition had identified as seats that could be won in 2019. 

In summary - the Coalition are accused of having adopted a strategic plan to win support in specific areas by approving more grants in those areas, to help them secure victory in the 2019 election.

So I decided to see what I could uncover from conducting a statistical analysis myself using data freely available online. To do this, I would need three key datasets:
(1) Information about each grant that was approved (location and $ amount),
(2) Election results for each electorate from the previous election, and
(3) Census data to control for other socio-demographic factors that might be at play.

With this data, I aim to see if I can find evidence to support or oppose these findings.

#### Obtaining the data

Sports Australia published a list of the 684 approved grants in a table on their website (https://www.sportaus.gov.au/grants_and_funding/community_sport_infrastructure_grant_program/successful_grant_recipient_list), which I scraped using *rvest*. I then look this list and fed it to a Google Maps API to get the lat-long coordinates of each grant (using *ggmap* from https://github.com/dkahle/ggmap). This worked for almost all of the grants, so I then did some quick googling to see find where these organisations were located.

To allocate each sporting organisation to its corresponding seat, I would need a map of electorates from the 2016 Federal election. Luckily, this is readily available in the `eechidna` package (which I maintain), along with the electoral voting data. I used some nifty functions from `sp` and `rgeos` to loop through the electorates and complete this allocation. 

Next I aggregated the grants, so that the resultant dataset would hold the total grant $ amount for each of the 150 Federal electorates. This was then joined with the two-party preferred vote from the 2016 election, along with a collection of socio-demographic variables from the 2016 Census - also obtained from `eechidna`.

Now with this dataset, it is time to get stuck into the analysis.

```{r}
df %>% 
  select(-Number_Grants) %>% 
  head
```


#### My approach

What I'm really looking to uncover is the relationship between the percentage of votes in favour of the Liberal party in the 2016 election and the amount of grant money allocated, for each electorate. First, let's see what a scatterplot looks like with a linear regression line fitted.

```{r}
df %>% 
  ggplot(aes(x = LNP_Percent, y = Amount)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(x = "% of Votes for Coalition", y = "Total Grant Money ($)")
```

There's some evidence here to suggest that electorates with stronger support for the Coalition were more likely to receive sports grant money. But really, its likely that if the Coalition did implement a targeted strategy in allocating grants, the relationship between these two variabls would not be linear. A strategy that gives the most money to seats that are the safest wouldn't be a very good one - because its highly unlikely that these seats would be vulnerable to changing hands at the 2019 election.

So instead of fitting a linear regression line, let's plot a really flexible regression curve. For this I have chosen to use the non-parametric LOESS curve, which gives higher weighting to local data points to fit a smooth curve. This allows us to get a better picture of the relationship between the 2016 vote and grant amount, rather than imposing a linear restriction.

```{r}
df %>% 
  ggplot(aes(x = LNP_Percent, y = Amount)) +
  geom_point() +
  geom_smooth(span = 0.5) +
  labs(x = "% of Votes for Coalition", y = "Total Grant Money ($)")
```

Wow! From looking at the initial scatterplot, it was hard to see whether there were any patterns, but the LOESS curve reveals a pretty significant relationship. There is a clear spike in the amount of grant money given to electorates that were "marginal" Coalition seats in the 2016 election. "Marginal" Coalition seats are those that were won by the Coalition where the candidate received less than 56% of the vote. I think this plot itself is pretty convincing evidence of a deliberate strategy in allocating the grants.

But to take this another step further, I decided to fit a GAM (Generalized Additive Model) to model the grant amount as a function of the 2016 vote, Census characteristics of the electorates and the swing vote (the percentage point change in the vote from 2013 to 2016 elections for that seat). Each of these variables is included in the model as a smooth term, which are penalized regression splines - a type of non-parametric regression, similar to LOESS. By doing this, I am effectively controlling for the effects of these other variables, so that the effect of the vote itself can be identified. It is possible that once these other effects are accounted for, we no longer see a relationship between the vote and grant amounts.

```{r}
mod <- gam(Amount ~ s(LNP_Percent) + s(Population) + s(MedianAge) + 
    s(MedianPersonalIncome) + s(HighSchool) + s(Unemployed) + s(Owned) + s(Swing),
  data = df)
visreg(mod, "LNP_Percent", alpha = 0.05)

mod2 <- gam(Amount ~ s(Population) + s(MedianAge) + 
    s(MedianPersonalIncome) + s(HighSchool) + s(Unemployed) + s(Owned),
  data = df)
```

After accounting for these other variables, it can be clearly seen that there still is a spike in grant amount for marginal Coalition seats! Having a look at the p-values from the GAM regression output, there is significant evidence that the 2016 vote influenced the allocation of grant money across electorates (p = 0.002). The resultant model itself explains 46.3% of the deviance - which is a good result considering that the official aim of the grant scheme was set out to increase sport engagement Australia-wide, and the applications were scored by an independent body. 

I also fit a model omitting the voting data (both two-party preferred and swing vote), and compared the two models with a Chi-square test. The model including the election data was a significantly better fit (p = 0.000005). On this basis, the evidence of pork-barrelling is quite compelling.

#### Checking that my findings are robust

Looking at the distribution of grant amounts across electorates with a simple boxplot reveals that there are two outliers with grant amounts of $1.8M and $2.0M - the electorates of Boothby and Dawson. I refit the model after removing those two electorates from the dataset, and still find that the effect of the 2016 vote is significant (p = 0.008), and the spike in grant amount still remains.

```{r}
mod_robust <- gam(Amount ~ s(LNP_Percent) + s(Population) + s(MedianAge) + 
    s(MedianPersonalIncome) + s(HighSchool) + s(Unemployed) + s(Owned) + s(Swing),
  data = df %>% 
    filter(Amount < 1600000))
visreg(mod_robust, "LNP_Percent", alpha = 0.05)
```

Similarly, when removing the seats with high Cook's Distance and refitting the model, the same effect is observed.

There also don't seem to be any material issues with the residuals as they appear approximately normal in a quantile-quantile plot.

```{r}
# Quantile-quantile plot
ggplot(aes(sample = mod$residuals), data = NULL) + 
  geom_qq() + 
  geom_qq_line()
```


#### Conclusion

My statistical modelling approach very much aligns with the findings of the ANAO report - that the allocation of grant money appears to have been strongly influenced by voting behaviour from the previous election. This analysis provides empirical evidence that an underlying strategy was used by the Coalition to try and beef up support in the lead up to the 2019 election. But perhaps far more importantly, it was a lot of fun to look into!

All of the data collection, wrangling and analysis was conducted using `R`. For anyone interested in exploring Australian election and Census data, I highly recommend checking out the `eechidna` package. This package makes it easy to access Australian election and Census data from 2001-2019 (including maps), available on CRAN. I am an author of, and currently maintain `eechidna`.

#### About me

Data science and analytics consultant at KPMG

If anyone would like to collaborate in analyses on this 

Check out my #medium debut on my analysis of the "Sports Rots" scandal - a statistical modelling to see how sporting grant money was allocated on the basis of previous election results, all done using the #eechidna #Rstats package and a Google Maps API.
